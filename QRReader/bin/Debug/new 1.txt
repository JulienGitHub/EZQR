require(["main"],function(){require(["config"],function(){require(["modules/StatsLeaderboards","models/applicationState","domReady"],function(e,t,n){n(function(){e.initialize({model:t})})})})}),define("stats-leaderboards",function(){}),define("modules/BaseModule",["require"],function(e){var t={initialize:function(e){e=e||{},this.model=e.model,_.bindAll(this);var t=this.model.get("initialized");t?this._initModule():this.model.on("change:initialized",this._initModule)},_initModule:function(){}};return t}),define("views/PageNavigationView",["require","constants/Elements","underscore","backbone","views/BaseView","constants/Layout","pep"],function(e){var t=e("constants/Elements"),n=e("underscore"),r=e("backbone"),i=e("views/BaseView"),s=e("constants/Layout"),o=e("pep"),u=i.extend({COLLAPSED_CLASS:"collapsed",EXPANDED_CLASS:"expanded",ANIMATE_OPEN_DURATION:.3,ANIMATE_CLOSED_DURATION:.3,ACTIVE_CLASS:"active",tagName:"ul",className:"page-navigation",events:function(){return{"pointerup .toggle div.page-navigation-header":"_onNavigationClick","pointerup .subnav li":"_onSubmenuClick"}},ui:{},initialize:function(e){e=e||{},n.bindAll(this),this.setElement(t(this.tagName+"."+this.className)),this.bindUIElements()},_onNavigationClick:function(e){var n=t(e.target).closest("li"),r=this.$el.find("li."+this.EXPANDED_CLASS);n.hasClass(this.EXPANDED_CLASS)?this._closeNav(n):(r&&this._closeNav(r),this._openNav(n))},_onSubmenuClick:function(e){var n=t(e.currentTarget);this.$el.find("li."+this.ACTIVE_CLASS).removeClass(this.ACTIVE_CLASS),n.addClass(this.ACTIVE_CLASS)},_closeNav:function(e){Modernizr.csstransitions?e.removeClass(this.EXPANDED_CLASS).addClass(this.COLLAPSED_CLASS):(e.removeClass(this.EXPANDED_CLASS).addClass(this.COLLAPSED_CLASS),TweenMax.to(e.find(".subnav"),this.ANIMATE_OPEN_DURATION,{height:"0","max-height":"0",ease:Cubic.easeOut}))},_openNav:function(e){Modernizr.csstransitions?e.removeClass(this.COLLAPSED_CLASS).addClass(this.EXPANDED_CLASS):(e.removeClass(this.COLLAPSED_CLASS).addClass(this.EXPANDED_CLASS),TweenMax.to(e.find(".subnav"),this.ANIMATE_CLOSED_DURATION,{height:"auto","max-height":"9999px",ease:Cubic.easeOut}))}});return u}),define("collections/TournamentsCollection",["require","models/BaseModel","collections/BaseCollection"],function(e){var t=e("models/BaseModel"),n=e("collections/BaseCollection"),r=n.extend({url:window.pokemonUI.api?window.pokemonUI.api["stats-leaderboards-data"]:"",model:t,cutoff:0,total_count:0,page_count:0,user_rank:null,user_progress:null,message:null,defaultMetadata:{total_count:0,page_count:0,relative_rank:0,progress:0,movement:0},initialize:function(e){e&&(e.url&&(this.url=e.url),e.urlSuffix&&(this.url=this.url+e.urlSuffix+"/"),this.isUserView=e.isUserView===!0)},parse:function(e){var t=e,n=this.defaultMetadata,r=[];return this.isUserView&&e.leaderboard&&e.leaderboard.relative_rank&&(t=e.leaderboard,this.user_rank=t.relative_rank||null,this.user_progress=t.progress||null,this.user_movement=t.movement||0),t._metadata&&(n=t._metadata),e.leaderboards?r=e.leaderboards:t.records?r=t.records:e.leaderboard&&(r=e.leaderboard.records,this.cutoff=e.leaderboard.cutoff||0),this.total_count=n.total_count||0,this.page_count=n.page_count||1,this.message=e.message||"",this.message_class=e.message_class||"",r}});return r}),define("templates/helpers/compare",["require","handlebars"],function(e){var t=typeof window=="undefined"?global:window,n=t.Handlebars||e("handlebars");n.registerHelper("compare",function(e,t,n,r){var i,s;if(arguments.length<3)throw new Error("Handlebars Helper 'compare' needs 2 parameters");r===undefined&&(r=n,n=t,t="==="),i={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},"typeof":function(e,t){return typeof e===t}};if(!i[t])throw new Error("Handlebars Helper 'compare' doesn't know the operator "+t);return s=i[t](e,n),s?r.fn(this):r.inverse(this)})}),define("templates/stats-leaderboards/stats-leaderboards-summary-block",["handlebars","templates/helpers/compare","templates/helpers/each"],function(e){return e.template({1:function(e,t,n,r,i){var s,o="\n";return s=t["if"].call(e,e!=null?e.showRowHeader:e,{name:"if",hash:{},fn:this.program(2,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o+="\n",s=t.each.call(e,e!=null?e.players:e,{name:"each",hash:{},fn:this.program(7,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o+"\n\n"},2:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u='  <li class="header-row">\n\n    <span class="header position">\n';return i=t["if"].call(e,e!=null?e.showPosition:e,{name:"if",hash:{},fn:this.program(3,r),inverse:this.noop,data:r}),i!=null&&(u+=i),u+='    </span>\n\n    <span class="header player">'+o(s((i=e!=null?e.dictionary:e)!=null?i.userHeader:i,e))+"</span>\n",i=t["if"].call(e,e!=null?e.showCountry:e,{name:"if",hash:{},fn:this.program(5,r),inverse:this.noop,data:r}),i!=null&&(u+=i),u+'    <span class="header score">'+o(s((i=e!=null?e.dictionary:e)!=null?i.scoreHeader:i,e))+"</span>\n  </li>\n"},3:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return"      "+o(s((i=e!=null?e.dictionary:e)!=null?i.rankHeader:i,e))+"\n"},5:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return'    <span class="header header-country">'+o(s((i=e!=null?e.dictionary:e)!=null?i.countryHeader:i,e))+"</span>\n"},7:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='  <li class="\n';return s=t["if"].call(e,i[1]!=null?i[1].highlightUser:i[1],{name:"if",hash:{},fn:this.program(8,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+="\n",s=t["if"].call(e,e!=null?e.in_cutoff:e,{name:"if",hash:{},fn:this.program(11,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+="\n",s=t["if"].call(e,i[1]!=null?i[1].highlightTopThree:i[1],{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='  ">\n    ',s=t["if"].call(e,e!=null?e.profile_url:e,{name:"if",hash:{},fn:this.program(20,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='\n\n      <span class="position\n',s=t["if"].call(e,i[1]!=null?i[1].showMovement:i[1],{name:"if",hash:{},fn:this.program(22,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='        "\n      >\n',s=t["if"].call(e,i[1]!=null?i[1].showPosition:i[1],{name:"if",hash:{},fn:this.program(27,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+="      </span>\n\n",s=t["if"].call(e,i[1]!=null?i[1].showAvatar:i[1],{name:"if",hash:{},fn:this.program(29,r,i),inverse:this.program(31,r,i),data:r}),s!=null&&(l+=s),l+="\n",s=t["if"].call(e,i[1]!=null?i[1].showCountry:i[1],{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='\n      <span class="score">'+f((o=(o=t.score||(e!=null?e.score:e))!=null?o:a,typeof o===u?o.call(e,{name:"score",hash:{},data:r}):o))+"</span>\n",s=t["if"].call(e,e!=null?e.profile_url:e,{name:"if",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+"\n  </li>\n"},8:function(e,t,n,r){var i,s=t.helperMissing,o="      ";return i=(t.compare||e&&e.compare||s).call(e,e!=null?e.is_logged_in:e,"==",1,{name:"compare",hash:{},fn:this.program(9,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+"\n"},9:function(e,t,n,r){return"active"},11:function(e,t,n,r){return"      qualified\n"},13:function(e,t,n,r){var i,s=t.helperMissing,o="      ";return i=(t.compare||e&&e.compare||s).call(e,e!=null?e.rank:e,"==",1,{name:"compare",hash:{},fn:this.program(14,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+="\n      ",i=(t.compare||e&&e.compare||s).call(e,e!=null?e.rank:e,"==",2,{name:"compare",hash:{},fn:this.program(16,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+="\n      ",i=(t.compare||e&&e.compare||s).call(e,e!=null?e.rank:e,"==",3,{name:"compare",hash:{},fn:this.program(18,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+"\n"},14:function(e,t,n,r){return"gold top-three"},16:function(e,t,n,r){return"silver top-three"},18:function(e,t,n,r){return"bronze top-three"},20:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'<a href="'+u((i=(i=t.profile_url||(e!=null?e.profile_url:e))!=null?i:o,typeof i===s?i.call(e,{name:"profile_url",hash:{},data:r}):i))+'">'},22:function(e,t,n,r){var i,s=t.helperMissing,o="          ";return i=(t.compare||e&&e.compare||s).call(e,e!=null?e.movement:e,"==",1,{name:"compare",hash:{},fn:this.program(23,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+="\n          ",i=(t.compare||e&&e.compare||s).call(e,e!=null?e.movement:e,"==",-1,{name:"compare",hash:{},fn:this.program(25,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+"\n"},23:function(e,t,n,r){return" positive"},25:function(e,t,n,r){return" negative"},27:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return"        "+u((i=(i=t.rank||(e!=null?e.rank:e))!=null?i:o,typeof i===s?i.call(e,{name:"rank",hash:{},data:r}):i))+".\n"},29:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'      <span class="player">\n        <span>'+u((i=(i=t.screen_name||(e!=null?e.screen_name:e))!=null?i:o,typeof i===s?i.call(e,{name:"screen_name",hash:{},data:r}):i))+"</span>\n      </span>\n"},31:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'      <span class="player">'+u((i=(i=t.screen_name||(e!=null?e.screen_name:e))!=null?i:o,typeof i===s?i.call(e,{name:"screen_name",hash:{},data:r}):i))+"</span>\n"},33:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'      <span class="country">\n        <span rel="tooltip" title="'+u((i=(i=t.country_name||(e!=null?e.country_name:e))!=null?i:o,typeof i===s?i.call(e,{name:"country_name",hash:{},data:r}):i))+'">'+u((i=(i=t.country||(e!=null?e.country:e))!=null?i:o,typeof i===s?i.call(e,{name:"country",hash:{},data:r}):i))+'</span>\n        <label class="offscreen">'+u((i=(i=t.country_name||(e!=null?e.country_name:e))!=null?i:o,typeof i===s?i.call(e,{name:"country_name",hash:{},data:r}):i))+"</label>\n      </span>\n"},35:function(e,t,n,r){return"    </a>\n"},37:function(e,t,n,r){var i,s=this.lambda,o="";return i=t.unless.call(e,e!=null?e.showRowHeader:e,{name:"unless",hash:{},fn:this.program(38,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o+='  <li>\n    <p class="no-data">',i=s((i=e!=null?e.dictionary:e)!=null?i.noData:i,e),i!=null&&(o+=i),o+="</p>\n  </li>\n",i=t.unless.call(e,e!=null?e.showRowHeader:e,{name:"unless",hash:{},fn:this.program(38,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o},38:function(e,t,n,r){return'  <li><span class="player">&nbsp;</span></li>\n  <li><span class="player">&nbsp;</span></li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o="\n";return s=t["if"].call(e,e!=null?e.players:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(37,r,i),data:r}),s!=null&&(o+=s),o},useData:!0,useDepths:!0})}),define("routers/StatsLeaderboardsRouter",["require","jquery","underscore","backbone","events/FormEvent"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("events/FormEvent"),s=r.Router.extend({routes:{"zone/:zone(/type/:type)(/who/:who)(/when/:when)(/page/:page)(/product/:product)(/league/:league)":"search","":"search"},search:function(e,n,r,s,o,u,a){t.publish(i.LEADERBOARD_SEARCH,[e,n,r,s,o,u,a])}});return s}),define("views/stats-leaderboards/StatsSummaryBlockView",["require","jquery","underscore","backbone","views/BaseView","collections/TournamentsCollection","templates/stats-leaderboards/stats-leaderboards-summary-block","controllers/CustomSelectList","utils/getCookie","utils/setCookie","events/FormEvent","routers/StatsLeaderboardsRouter"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("views/BaseView"),s=e("collections/TournamentsCollection"),o=e("templates/stats-leaderboards/stats-leaderboards-summary-block"),u=e("controllers/CustomSelectList"),a=e("utils/getCookie"),f=e("utils/setCookie"),l=e("events/FormEvent"),c=e("routers/StatsLeaderboardsRouter"),h=i.extend({hasData:!1,resultsCount:5,cookieName:null,cookieNameOP:"pokemon-leaderboards-op",cookieNameTCGO:"pokemon-leaderboards-tcgo",cookieSettings:null,el:".stats-n-leaderboards",ui:{$summaryBlocksContainer:"#stats-leaderboards-landing-summary-block",$summaryBlocks:".leaderboard-summary-block",$typeFilter:"#leaderboardTypeFilter",$zoneFilter:"#leaderboardZoneFilter"},events:{"change #leaderboardTypeFilter":"_onFilterChange","change #leaderboardZoneFilter":"_onFilterChange"},classnames:{loader:"loader",loading:"loading"},selectors:{loader:".loader",table:".leaderboard-summary-table"},dictionary:null,template:o,collection:null,blocksLength:0,currentTypeFilter:null,currentTypeCount:0,currentZoneFilter:null,router:new c,params:{zone:null,type:null},mockEvent:null,initialize:function(){t.subscribe(l.LEADERBOARD_SEARCH,t.proxy(this.initializeForm,this)),r.History.started||r.history.start(),this.bindUIElements(),this.dictionary=window.pokemonUI.dictionary.statsLeaderboards||{},this.blocksLength=this.ui.$summaryBlocksContainer.length,this.blocksLength&&(this.collection=new s,this.leaderboard_type=this.ui.$summaryBlocksContainer.data("leaderboard-id"),this.cookieName=this.leaderboard_type==="tcgo"?this.cookieNameTCGO:this.cookieNameOP,this.cookieSettings=JSON.parse(decodeURI(a(this.cookieName))),this._setInitialFilters(),this.mockEvent!==null&&(this._onFilterChange(this.mockEvent),this.mockEvent=null))},_setInitialFilters:function(){this.cookieSettings!==null?(this.cookieSettings.TypeFilter!==null&&(this.params&&this.params.type?(this.ui.$typeFilter.val(this.params.type),this.params.type=null):this.cookieSettings.TypeFilter!==null&&this.ui.$typeFilter.val(this.cookieSettings.TypeFilter)),this.cookieSettings.ZoneFilter!==null&&(this.params&&this.params.zone?(this.ui.$zoneFilter.val(this.params.zone),this.params.zone=null):this.cookieSettings.ZoneFilter!==null&&this.ui.$zoneFilter.val(this.cookieSettings.ZoneFilter))):(this.cookieSettings={},this.cookieSettings.TypeFilter=null,this.cookieSettings.ZoneFilter=this.dictionary.userFilterZone||null,this.cookieSettings.ZoneFilter!==null&&this.ui.$zoneFilter.val(this.cookieSettings.ZoneFilter),this.cookieSettings.WhoFilter=null,this.cookieSettings.WhenFilter=null,this.cookieSettings.ProductFilter=null,this.cookieSettings.LeagueFilter=null),this.currentTypeFilter=this.ui.$typeFilter.val(),this.ui.$zoneFilter.length&&(this.currentZoneFilter=this.ui.$zoneFilter.val()),this._saveCookieFilters();var e=this.$el.find("select.leaderboard-select"),n=e.length,r="class",i;if(n){var s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(i=0;i<n;i++){var o=t(e[i]),u=o.parent("div"),a=u.attr(r);if(o.parents(".disable-custom-select-menu").length||s){u.css("visibility","visible");continue}u.addClass("custom-select-wrapper"),o.customSelectMenu({maxHeight:o.data("height")||0});var f=u.find("label");f.attr(r,a),u.css("visibility","visible")}var l=this.ui.$typeFilter.find("option:selected"),c=l.attr("class"),h=this.ui.$typeFilter.parent().find(".custom-select-menu label");h.addClass(c)}},_saveCookieFilters:function(){this.ui.$typeFilter.val()!==null&&(this.cookieSettings.TypeFilter=this.ui.$typeFilter.val()),this.ui.$zoneFilter.val()!==null&&(this.cookieSettings.ZoneFilter=this.ui.$zoneFilter.val()),f(this.cookieName,encodeURI(JSON.stringify(this.cookieSettings)),365)},initializeForm:function(e,t,n,r,i,s){this.params.zone=t,this.params.type=n,this.mockEvent={currentTarget:"select#leaderboardZoneFilter.leaderboard-select"}},_onFilterChange:function(e){var n=t(e.currentTarget),r=n.attr("id").indexOf("Type")>0,i=n.val();if(!this.hasData||r&&i!==this.currentTypeFilter||!r&&i!==this.currentZoneFilter)r?this.currentTypeFilter=i:this.currentZoneFilter=i,this._saveCookieFilters(),this._updateSummaryBlocks()},_buildURI:function(){return"zone/"+this.currentZoneFilter+"/type/"+this.currentTypeFilter},_updateSummaryBlocks:function(){var e=this,n;this.ui.$summaryBlocks.each(function(t,n){e._addLoadingIndicator(n)}),n={leaderboard_type:e.currentTypeFilter,page:1,include:"metadata",format:"json"},this.currentZoneFilter!=="All"&&(n.zone=this.currentZoneFilter),e.collection.fetch({data:n,success:t.proxy(e._onDataSuccess,e),error:t.proxy(e._onDataError,e)})},_addLoadingIndicator:function(e){var n=t(e).find(this.selectors.table),r=t('<div class="'+this.classnames.loader+'" />'),i=n.outerHeight();n.addClass(this.classnames.loading).css("min-height",i).html(r)},_removeLoadingIndicator:function(e,n,r){var i=t(e).find(this.selectors.table);i.css("min-height","").html(n).removeClass(this.classnames.loading)},_onDataSuccess:function(){var e=this.collection.toJSON(),t=this.dictionary,n=this,r,i;this.ui.$summaryBlocks.each(function(s,o){i=e[s].records,r=n.template({dictionary:t,showRowHeader:!1,showAvatar:!0,showCountry:!0,showPosition:!0,highlightUser:!1,highlightTopThree:!1,players:i}),n._removeLoadingIndicator(o,r,!0),this.hasData=!0})},_onDataError:function(){var e=this;this.ui.$summaryBlocks.each(function(t,n){e._removeLoadingIndicator(n,'<p class="error">'+e.dictionary.errorMessage+"</p>",!1)})}});return h}),define("templates/stats-leaderboards/stats-leaderboards-user-rank-card",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a='\n<div class="progress-bar">\n  <span class="ranking">';return i=(s=(s=t.rank||(e!=null?e.rank:e))!=null?s:u,typeof s===o?s.call(e,{name:"rank",hash:{},data:r}):s),i!=null&&(a+=i),a+='</span>\n  <span class="filler"></span>\n</div>\n\n<!--\n<div class="progress-info">\n  <p>',i=(s=(s=t.progress||(e!=null?e.progress:e))!=null?s:u,typeof s===o?s.call(e,{name:"progress",hash:{},data:r}):s),i!=null&&(a+=i),a+"</p>\n</div>\n-->"},useData:!0})}),define("views/stats-leaderboards/StatsUserCardView",["require","jquery","underscore","backbone","TweenMax","events/LayoutEvent","views/BaseView","collections/TournamentsCollection","templates/stats-leaderboards/stats-leaderboards-summary-block","templates/stats-leaderboards/stats-leaderboards-user-rank-card"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("TweenMax"),s=e("events/LayoutEvent"),o=e("views/BaseView"),u=e("collections/TournamentsCollection"),a=e("templates/stats-leaderboards/stats-leaderboards-summary-block"),f=e("templates/stats-leaderboards/stats-leaderboards-user-rank-card"),l=o.extend({resultsCount:5,el:".stats-n-leaderboards",ui:{$container:"#stats-leaderboards-user-card",$table:"#stats-leaderboards-user-card > .leaderboard-summary-table",$userStats:"div.user-rank-progress",$summaryBlocks:".leaderboard-summary-block",$typeFilter:"#leaderboardTypeFilter",$zoneFilter:"#leaderboardZoneFilter",$whenFilter:"#leaderboardWhenFilter",$signUp:".sign-up-rank"},events:{"change #leaderboardTypeFilter":"_onFilterChange","change #leaderboardZoneFilter":"_onFilterChange","change #leaderboardWhenFilter":"_onFilterChange"},classnames:{active:"active",inactive:"inactive",loader:"loader",loading:"loading",unavailable:"unavailable"},selectors:{active:".active",inactive:".inactive",loader:".loader"},dictionary:null,template:a,userStatsTpl:f,collection:null,currentTypeFilter:null,currentWhenFilter:null,currentZoneFilter:null,leaderboard_name:null,product:null,league:null,initialize:function(e){this.bindUIElements(),this.dictionary=e.dictionary||{},this.ui.$container.length&&(this.currentTypeFilter=this.ui.$typeFilter.val(),this.currentZoneFilter=this.ui.$zoneFilter.val(),this.currentWhenFilter=this.ui.$whenFilter.val(),this.leaderboard_name=this.ui.$container.data("tournament-id"),this._setProductLeagueFilters(this.leaderboard_name),this.collection=new u({isUserView:!0,urlSuffix:this.leaderboard_name}),this._updatePlayersProfileData())},_onFilterChange:function(e){var n=t("#leaderboard-message-area");n.html("");var r=t(e.currentTarget),i=r.attr("id")||"",s=i.indexOf("Type")>0,o=i.indexOf("Zone")>0,u=i.indexOf("When")>0,a=r.val()||parseInt(r.text(),10);if(s&&a!==this.currentTypeFilter||o&&a!==this.currentZoneFilter||u&&a!==this.currentWhenFilter)s?this.currentTypeFilter=a:o?this.currentZoneFilter=a:u&&(this.currentWhenFilter=a),this._updatePlayersProfileData()},_setProductLeagueFilters:function(e){e.indexOf("tcg-")>=0?(this.product="tcg",this.league=e.replace("tcg-","")):e.indexOf("vg-")>=0?(this.product="vg",this.league=e.replace("vg-","")):(this.product="",this.league=e)},_updatePlayersProfileData:function(){this._addLoadingIndicator();var e=this,n={isUserStats:!0,product:e.product,league:e.league,leaderboard_type:e.currentTypeFilter,leaderboard_when:e.currentWhenFilter,per_page:e.resultsCount,page:e.currentResultPage,include:"metadata",format:"json"};this.currentZoneFilter!=="All"&&(n.zone=this.currentZoneFilter),this.collection.fetch({data:n,success:t.proxy(e._onDataSuccess,e),error:t.proxy(e._onDataError,e)})},_addLoadingIndicator:function(){var e=t('<div class="'+this.classnames.loader+'" />'),n=this.ui.$table.outerHeight();this.ui.$table.addClass(this.classnames.loading).css("min-height",n).html(e)},_removeLoadingIndicator:function(e,t){this.ui.$table.css("min-height","").html(e).removeClass(this.classnames.loading)},_onDataSuccess:function(){var e=this.collection.toJSON(),n=this,r="";this.collection.user_rank!==null?this.userRank=this.collection.user_rank:this.userRank=this.dictionary.userStatsRank,this.collection.user_progress!==null?this.userProgress=this.collection.user_progress:this.userProgress=this.dictionary.userStatsProgress;var i=t("#leaderboard-message-area"),s=this.collection.message,o=this.collection.message_class;i&&i.html()===""&&(s&&i.html(s),i.removeClass(),o&&i.addClass(o)),this.userRank>0&&e.length>0?(r=this.template({dictionary:n.dictionary,showRowHeader:!0,showMovement:!1,showAvatar:!0,showCountry:!0,showPosition:!1,highlightUser:!0,highlightTopThree:!1,players:e}),this.resultsTotalCount=this.collection.total_count||1,this.resultsTotalPages=this.collection.page_count||1,this.ui.$container.show(),this._renderUserStats()):this.ui.$container.hide(),this._removeLoadingIndicator(r,!0)},_renderUserStats:function(){var e={dictionary:this.dictionary};this.userRank>0&&(e.rank=this.userRank<1?this.dictionary.userTopLabel+" "+parseInt(this.userRank*100,10)+"%":this.dictionary.userRankLabel+"<br />"+this.dictionary.numberPrefix+this.userRank,e.progress=this.userProgress>=0?"<span>"+this.dictionary.upLabel+"</span> ":"<span>"+this.dictionary.dnLabel+"</span> ",e.progress+=Math.abs(this.userProgress)+this.dictionary.userStatsRange,this.ui.$userStats.html(this.userStatsTpl(e)),t.publish(s.RESIZE),setTimeout(function(){this._animateProgressBar()}.bind(this),400))},_animateProgressBar:function(){var e=this.ui.$userStats.find(".progress-bar"),n=e.find(".filler"),r=e.find(".ranking"),o=this.userRank<1?this.userRank*100:this.userRank,u=e.outerHeight(),a=parseInt(u*(100-o)*.01,10),f,l=this;a<0&&(a=u/2),o>50?(r.addClass("above").removeClass("below"),f=a+20):(r.removeClass("above").addClass("below"),f=a-r.outerHeight()-20),i.fromTo(n,1,{css:{height:0}},{css:{height:a+"px"},ease:Back.easeOut}),i.fromTo(r,1.5,{css:{bottom:"60px"}},{css:{bottom:f+"px"},ease:Back.easeIn}),t.publish(s.RESIZE)},_onDataError:function(){this._removeLoadingIndicator('<p class="error">'+this.dictionary.errorMessage+"</p>",!1),t.publish(s.RESIZE)}});return l}),define("templates/stats-leaderboards/stats-leaderboards-typeahead",["handlebars","templates/helpers/compare","templates/helpers/each"],function(e){return e.template({1:function(e,t,n,r){var i,s='  <ul class="typeahead">\n\n';return i=t.each.call(e,e!=null?e.players:e,{name:"each",hash:{},fn:this.program(2,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s+"\n  </ul>\n"},2:function(e,t,n,r){var i,s=t.helperMissing,o="";return i=(t.compare||e&&e.compare||s).call(e,r&&r.index,"<",10,{name:"compare",hash:{},fn:this.program(3,r),inverse:this.noop,data:r}),i!=null&&(o+=i),o},3:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'      <li><a href="?guid='+u((i=(i=t.guid||(e!=null?e.guid:e))!=null?i:o,typeof i===s?i.call(e,{name:"guid",hash:{},data:r}):i))+'">'+u((i=(i=t.screen_name||(e!=null?e.screen_name:e))!=null?i:o,typeof i===s?i.call(e,{name:"screen_name",hash:{},data:r}):i))+"</a></li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="\n";return i=t["if"].call(e,e!=null?e.players:e,{name:"if",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},useData:!0})}),define("templates/stats-leaderboards/stats-leaderboards-pagination",["handlebars","templates/helpers/each"],function(e){return e.template({1:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a='  <li class="pageFilter ';return i=(s=(s=t.classname||(e!=null?e.classname:e))!=null?s:u,typeof s===o?s.call(e,{name:"classname",hash:{},data:r}):s),i!=null&&(a+=i),a+='">',i=(s=(s=t.value||(e!=null?e.value:e))!=null?s:u,typeof s===o?s.call(e,{name:"value",hash:{},data:r}):s),i!=null&&(a+=i),a+"</li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="\n";return i=t.each.call(e,e!=null?e.links:e,{name:"each",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},useData:!0})}),define("views/stats-leaderboards/StatsSelectedView",["require","jquery","underscore","backbone","views/BaseView","views/stats-leaderboards/StatsUserCardView","collections/TournamentsCollection","collections/BaseCollection","templates/stats-leaderboards/stats-leaderboards-summary-block","templates/stats-leaderboards/stats-leaderboards-typeahead","templates/stats-leaderboards/stats-leaderboards-pagination","controllers/MatchHeightController","controllers/CustomSelectList","utils/getCookie","utils/setCookie","events/FormEvent","routers/StatsLeaderboardsRouter","analytics/AdobeAnalytics"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("views/BaseView"),s=e("views/stats-leaderboards/StatsUserCardView"),o=e("collections/TournamentsCollection"),u=e("collections/BaseCollection"),a=e("templates/stats-leaderboards/stats-leaderboards-summary-block"),f=e("templates/stats-leaderboards/stats-leaderboards-typeahead"),l=e("templates/stats-leaderboards/stats-leaderboards-pagination"),c=e("controllers/MatchHeightController"),h=e("controllers/CustomSelectList"),p=e("utils/getCookie"),d=e("utils/setCookie"),v=e("events/FormEvent"),m=e("routers/StatsLeaderboardsRouter"),g=e("analytics/AdobeAnalytics"),y=i.extend({hasData:!1,minSearchCount:3,isSearching:!1,searchTimeout:null,searchValue:"",searchProvider:"",cookieName:null,cookieNameOP:"pokemon-leaderboards-op",cookieNameTCGO:"pokemon-leaderboards-tcgo",cookieNameCHAMP:"pokemon-leaderboards-championship",cookieSettings:null,paginationLength:4,paginationObject:{links:[]},resultsCount:25,currentResultPage:1,resultsTotalCount:1,resultsTotalPages:1,pageInit:!1,router:new m,params:{zone:null,type:null,when:null,who:null,product:null,league:null},mockEvent:null,el:".stats-n-leaderboards",ui:{$container:"#stats-leaderboards-selected-rankings",$table:"#stats-leaderboards-selected-rankings > .leaderboard-summary-table",$userCard:"#stats-leaderboards-user-card",$summaryBlocks:".leaderboard-summary-block",$messageArea:"#leaderboard-message-area",$productFilter:"#leaderboardProductFilter",$leagueFilter:"#leaderboardLeagueFilter",$typeFilter:"#leaderboardTypeFilter",$zoneFilter:"#leaderboardZoneFilter",$whoFilter:"#leaderboardWhoFilter",$whenFilter:"#leaderboardWhenFilter",$showFilters:".showFilter",$pageFilterContainer:"ul.stats-leaderboards-pagination",$pageFilters:".pageFilter",$searchForm:"form.search-player",$searchInput:'form.search-player > input[type="text"]',$searchButton:"form.search-player > button",$hiddenFiltersChamp:".hidden-champ",$hiddenFiltersPlay:".hidden-play"},events:{"change #leaderboardTypeFilter":"_onFilterChange","change #leaderboardZoneFilter":"_onFilterChange","change #leaderboardWhoFilter":"_onFilterChange","change #leaderboardWhenFilter":"_onFilterChange","change #leaderboardProductFilter":"_onFilterChange","change #leaderboardLeagueFilter":"_onFilterChange","click .showFilter":"_onFilterChange","click ul.stats-leaderboards-pagination li":"_onFilterChange"},classnames:{active:"active",container:"stats-n-leaderboards",championship:"leaderboard-championship-table",disabled:"disabled",inactive:"inactive",loader:"loader",loading:"loading",next:"next",pageOne:"page-one",pageFilter:"pageFilter",prev:"prev",qualifiedBye:"qualified-bye",qualified:"qualified",qualifiedNot:"not-qualified",showFilter:"showFilter",unavailable:"unavailable"},selectors:{active:".active",inactive:".inactive",loader:".loader"},dictionary:null,template:a,typeAheadTpl:f,pagination:l,collection:null,currentTypeFilter:null,currentWhenFilter:null,currentWhoFilter:null,currentZoneFilter:null,currentProductFilter:null,currentLeagueFilter:null,leaderboard_name:null,leaderboard_type:null,initialize:function(){t.subscribe(v.LEADERBOARD_SEARCH,t.proxy(this.initializeForm,this)),r.History.started||r.history.start();var e=new RegExp("CurrentSeason","g"),n=this;this.bindUIElements(),this.dictionary=window.pokemonUI.dictionary.statsLeaderboards||{},this.ui.$container.length&&(this.leaderboard_name=this.ui.$container.data("tournament-id"),this.leaderboard_type=this.ui.$container.data("leaderboard-id"),this.cookieName=this.leaderboard_type==="tcgo"?this.cookieNameTCGO:this.leaderboard_type==="op"?this.cookieNameOP:this.cookieNameCHAMP,this.cookieSettings=JSON.parse(decodeURI(p(this.cookieName))),this._setInitialFilters(),this.dictionary.paginationPages>0&&(this.currentResultPage=parseInt(this.dictionary.currentPage,10),this.resultsTotalCount=parseInt(this.dictionary.paginationRecords,10),this.resultsTotalPages=parseInt(this.dictionary.paginationPages,10),this._updatePaginationControls()),this.ui.$userCard.length&&(this.userStatsView=new s({dictionary:this.dictionary})),this.collection=new o({urlSuffix:this.cookieName===this.cookieNameCHAMP?"":this.leaderboard_name}),this.searchCollection=new u({}),this.ui.$searchInput.on("keyup",t.proxy(this._onSearchInputChange,this)),this.ui.$searchForm.on("submit",t.proxy(this._onSearchSubmit,this)),this.ui.$table.hasClass(this.classnames.championship)&&this._addChampionshipHighlights(),this._updatePlayersData(),this.mockEvent!==null&&(this._onFilterChange(this.mockEvent),this.mockEvent=null))},initializeForm:function(e,t,n,r,i,s,o,u){this.params.zone=t,this.params.type=n,this.params.who=r,this.params.when=i,this.params.product=o,this.params.league=u,s!==undefined&&(this.currentResultPage=parseInt(s),this.pageInit=!0),this.mockEvent={currentTarget:"select#leaderboardZoneFilter.leaderboard-select"}},_onFilterChange:function(e){this.ui.$messageArea.html("");var n=t(e.currentTarget),r=n.attr("id")||"",i=r.indexOf("Type")>0,s=r.indexOf("Zone")>0,o=r.indexOf("Who")>0,u=r.indexOf("When")>0,a=r.indexOf("Product")>0,f=r.indexOf("League")>0,l=n.hasClass(this.classnames.showFilter),c=n.hasClass(this.classnames.pageFilter),h=n.hasClass(this.classnames.prev),p=n.hasClass(this.classnames.next),d=0,v=n.val()||parseInt(n.text(),10);if(!this.hasData||i&&v!==this.currentTypeFilter||s&&v!==this.currentZoneFilter||o&&v!==this.currentWhoFilter||u&&v!==this.currentWhenFilter||a&&v!==this.currentProductFilter||f&&v!==this.currentLeagueFilter||l&&v!==this.resultsCount||c&&!n.hasClass(this.classnames.active)&&!n.hasClass(this.classnames.unavailable))c?h||p?this.currentResultPage+=h?-1:1:this.currentResultPage=v:(this.pageInit?this.pageInit=!1:this.currentResultPage=1,i?(this.currentTypeFilter=v,this._toggleTypeWhenFilters()):s?this.currentZoneFilter=v:o?this.currentWhoFilter=v:u?this.currentWhenFilter=v:a?this.currentProductFilter=v:f?this.currentLeagueFilter=v:l&&(this.ui.$showFilters.filter(this.selectors.active).removeClass(this.classnames.active),n.addClass(this.classnames.active),this.resultsCount=v)),this.currentResultPage<=1?this.ui.$table.addClass(this.classnames.pageOne):this.ui.$table.removeClass(this.classnames.pageOne),this._updatePlayersData(),this._saveCookieFilters()},_buildURI:function(){var e={zone:this.currentZoneFilter,type:this.currentTypeFilter,who:this.currentWhoFilter,when:this.currentWhenFilter,page:this.currentResultPage,product:this.currentProductFilter,league:this.currentLeagueFilter},t=[];for(var n in e)e[n]!=null&&(t[t.length]=n+"/"+e[n]);return t.join("/")},_updatePlayersData:function(){var e=this,n={leaderboard_type:e.currentTypeFilter,leaderboard_when:e.currentWhenFilter,leaderboard_who:e.currentWhoFilter,per_page:e.resultsCount,page:e.currentResultPage,include:"metadata",format:"json"};this.ui.$table.hasClass(this.classnames.championship)&&(n.product=this.currentProductFilter,n.league=this.currentLeagueFilter),this._addLoadingIndicator(),this.currentZoneFilter!=="All"&&(n.zone=this.currentZoneFilter),this.collection.fetch({data:n,success:t.proxy(e._onDataSuccess,e),error:t.proxy(e._onDataError,e)})},_addLoadingIndicator:function(){var e=t('<div class="'+this.classnames.loader+'" />'),n=this.ui.$table.outerHeight();this.ui.$table.addClass(this.classnames.loading).css("min-height",n).html(e)},_removeLoadingIndicator:function(e,t){this.ui.$table.css("min-height","").html(e).removeClass(this.classnames.loading),g.track("SelectedLeaderboard")},_updatePaginationControls:function(){var e=Math.floor(this.paginationLength*.5),t=this.currentResultPage,n,r,i=0,s,o,u;this.paginationObject.links=[],n=Math.max(1,t-e),r=Math.min(this.resultsTotalPages,n+this.paginationLength),t+e>=this.resultsTotalPages&&(n-=t+e-this.resultsTotalPages,n=Math.max(1,n)),this._appendPaginationLink("&lsaquo;",this.resultsTotalPages<=this.paginationLength?"prev hidden":t<=1?"prev inactive":"prev"),n!==1&&r>this.paginationLength&&(this._appendPaginationLink(1,""),n!==2&&this._appendPaginationLink("...",this.classnames.unavailable));for(o=n;o<=r;o++)this._appendPaginationLink(o,o===t?this.classnames.active:"");r!==this.resultsTotalPages&&r>this.paginationLength&&(r!==this.resultsTotalPages-1&&this._appendPaginationLink("...",this.classnames.unavailable),this._appendPaginationLink(this.resultsTotalPages,"")),this._appendPaginationLink("&rsaquo;",this.resultsTotalPages<=this.paginationLength?"next hidden":t>=this.resultsTotalPages?"next inactive":"next"),u=n===r?"":this.pagination(this.paginationObject),this.ui.$pageFilterContainer.html(u),this.currentResultPage<=1?this.ui.$table.addClass(this.classnames.pageOne):this.ui.$table.removeClass(this.classnames.pageOne)},_appendPaginationLink:function(e,t){this.paginationObject.links.push({value:e,classname:t})},_onDataSuccess:function(){var e=this.collection.toJSON(),t=this,n=this.collection.message,r=this.template({dictionary:t.dictionary,showRowHeader:!0,showMovement:!0,showAvatar:!0,showCountry:!0,showPosition:!0,highlightUser:!1,highlightTopThree:this.collection.cutoff===0,players:e,cutoff:this.collection.cutoff});this.ui.$messageArea&&this.ui.$messageArea.html()===""&&(n&&this.ui.$messageArea.html(n),this.ui.$messageArea.removeClass(),this.collection.message_class&&this.ui.$messageArea.addClass(this.collection.message_class)),this.resultsTotalCount=this.collection.total_count||1,this.resultsTotalPages=this.collection.page_count||1,this._removeLoadingIndicator(r,!0),this._updatePaginationControls(),this.ui.$table.hasClass(this.classnames.championship)&&this._addChampionshipHighlights(),this.hasData=!0},_addChampionshipHighlights:function(){var e=this;this.ui.$table.find("li:not(.header-row)").each(function(n){var r=t(this),i=parseInt(r.find(".position").text(),10),s=parseInt(r.find(".score").text(),10);r.addClass(e.classnames.qualifiedNot)})},_setInitialFilters:function(){this.cookieSettings!==null?(this.ui.$typeFilter.length&&(this.params&&this.params.type?(this.ui.$typeFilter.val(this.params.type),this.params.type=null):this.cookieSettings.TypeFilter!==null&&this.ui.$typeFilter.val(this.cookieSettings.TypeFilter)),this.ui.$zoneFilter.length&&(this.params&&this.params.zone?(this.ui.$zoneFilter.val(this.params.zone),this.params.zone=null):this.cookieSettings.ZoneFilter!==null&&this.ui.$zoneFilter.val(this.cookieSettings.ZoneFilter)),this.cookieSettings.WhoFilter!==undefined&&this.ui.$whoFilter.length?this.params&&this.params.who?(this.ui.$whoFilter.val(this.params.who),this.params.who=null):this.cookieSettings.WhoFilter!==null&&this.ui.$whoFilter.val(this.cookieSettings.WhoFilter):this.cookieSettings.WhoFilter="all",this.ui.$whenFilter.length&&(this.params&&this.params.when?(this.ui.$whenFilter.val(this.params.when),this.params.when=null):this.cookieSettings.WhenFilter!==null&&this.ui.$whenFilter.val(this.cookieSettings.WhenFilter)),this.cookieSettings.ProductFilter!==null&&this.ui.$productFilter.length&&(this.params&&this.params.product?(this.ui.$productFilter.val(this.params.product),this.params.productFilter=null):this.cookieSettings.ProductFilter!==null&&this.ui.$productFilter.val(this.cookieSettings.ProductFilter)),this.cookieSettings.LeagueFilter!==null&&this.ui.$leagueFilter.length&&(this.params&&this.params.league?(this.ui.$leagueFilter.val(this.params.league),this.params.league=null):this.cookieSettings.LeagueFilter!==null&&this.ui.$leagueFilter.val(this.cookieSettings.LeagueFilter))):(this.cookieSettings={},this.cookieSettings.TypeFilter=null,this.cookieSettings.ZoneFilter=this.dictionary.userFilterZone||null,this.cookieSettings.WhoFilter="all",this.cookieSettings.WhenFilter=null,this.cookieSettings.ProductFilter=null,this.cookieSettings.LeagueFilter=null),this.ui.$typeFilter.length&&(this.currentTypeFilter=this.ui.$typeFilter.val()),this.ui.$whoFilter.length&&(this.currentWhoFilter=this.ui.$whoFilter.val()),this.ui.$whenFilter.length&&(this.currentWhenFilter=this.ui.$whenFilter.val()),this.ui.$productFilter.length&&(this.currentProductFilter=this.ui.$productFilter.val()?this.ui.$productFilter.val().toLowerCase():null),this.ui.$leagueFilter.length&&(this.currentLeagueFilter=this.ui.$leagueFilter.val()?this.ui.$leagueFilter.val().toLowerCase():null),this.ui.$zoneFilter.length&&(this.currentZoneFilter=this.ui.$zoneFilter.val()),this.currentProductFilter===this.currentLeagueFilter&&(this.leaderboard_name.indexOf("tcg-")>=0?(this.currentProductFilter="tcg",this.currentLeagueFilter=this.leaderboard_name.replace("tcg-","")):this.leaderboard_name.indexOf("vg-")>=0?(this.currentProductFilter="vg",this.currentLeagueFilter=this.leaderboard_name.replace("vg-","")):(this.currentProductFilter="",this.currentLeagueFilter=this.leaderboard_name));var e=this.$el.find("select.leaderboard-select"),n=e.length,r="class",i,s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(n){for(i=0;i<n;i++){var o=t(e[i]),u=o.parent("div"),a=u.attr(r);if(o.parents(".disable-custom-select-menu").length||s){u.css("visibility","visible");continue}u.addClass("custom-select-wrapper"),o.customSelectMenu({maxHeight:o.data("height")||0});var f=u.find("label");f.attr(r,a),u.css("visibility","visible")}var l=this.ui.$typeFilter.find("option:selected"),c=l.attr("class"),h=this.ui.$typeFilter.parent().find(".custom-select-menu label");h.addClass(c)}this.ui.$hiddenFiltersChamp=this.$el.find(".hidden-champ"),this.ui.$hiddenFiltersPlay=this.$el.find(".hidden-play"),t("li.leaderboard__qp-toggle").addClass("hidden");var p=t("li.leaderboard__qp-toggle."+this.currentTypeFilter);p.removeClass("hidden"),this._toggleTypeWhenFilters(),this._saveCookieFilters()},_saveCookieFilters:function(){this.ui.$typeFilter.length&&(this.cookieSettings.TypeFilter=this.ui.$typeFilter.val()),this.ui.$zoneFilter.length&&(this.cookieSettings.ZoneFilter=this.ui.$zoneFilter.val()),this.ui.$whoFilter.length&&(this.cookieSettings.WhoFilter=this.ui.$whoFilter.val()),this.ui.$whenFilter.length&&(this.cookieSettings.WhenFilter=this.ui.$whenFilter.val()),this.ui.$productFilter.length&&(this.cookieSettings.ProductFilter=this.ui.$productFilter.val()),this.ui.$leagueFilter.length&&(this.cookieSettings.LeagueFilter=this.ui.$leagueFilter.val()),d(this.cookieName,encodeURI(JSON.stringify(this.cookieSettings)),365)},_toggleTypeWhenFilters:function(){if(this.leaderboard_type==="op"&&t("li.leaderboard__qp-toggle.hidden."+this.currentTypeFilter).length>0){t("li.leaderboard__qp-toggle").addClass("hidden");var e=t("li.leaderboard__qp-toggle."+this.currentTypeFilter);e.removeClass("hidden"),t("#leaderboardWhenFilter").trigger("reset")}if(this.leaderboard_type==="tcgo"){var n=this.ui.$whenFilter.find(":selected").index(),r=0;this.currentTypeFilter==="play"?(this.ui.$hiddenFiltersPlay.hide().filter("option").attr("disabled","disabled"),this.ui.$hiddenFiltersChamp.show().filter("option").removeAttr("disabled"),r=n===5?3:2):(this.ui.$hiddenFiltersPlay.show().filter("option").removeAttr("disabled"),this.ui.$hiddenFiltersChamp.hide().filter("option").attr("disabled","disabled"),r=n===3?5:4)}},_onDataError:function(){this._removeLoadingIndicator('<p class="error">'+this.dictionary.errorMessage+"</p>",!1)},_onSearchInputChange:function(){if(this.isSearching)return;this.searchValue=this.ui.$searchInput.val().trim(),this.searchProvider=this.leaderboard_type,this.searchTimeout!==null&&clearTimeout(this.searchTimeout),this.searchValue.length>=this.minSearchCount&&(this.searchTimeout=setTimeout(function(){this.isSearching=!0,this._searchCollectionUpdate(),this.searchTimeout=null}.bind(this),200))},_searchCollectionUpdate:function(){var e=this;this.searchCollection.fetch({url:window.pokemonUI.api["stats-leaderboards-search"]||"",data:{search_text:e.searchValue,provider:this.searchProvider},success:t.proxy(e._onSearchSuccess,e),error:t.proxy(e._onSearchError,e)})},_onSearchSuccess:function(){var e=this.searchCollection.toJSON(),n=this,r=this.typeAheadTpl({players:e});this.isSearching=!1,this.ui.$searchForm.find("ul.typeahead").remove(),this.ui.$searchInput.after(r),this.ui.$searchForm.find("ul.typeahead").on("click","li",function(e){var r=t(e.currentTarget);n.ui.$searchInput.val(r.text()),r.parent().remove()}),this.ui.$searchForm.find("ul.typeahead").length?this.ui.$searchForm.addClass(this.classnames.active):this.ui.$searchForm.removeClass(this.classnames.active)},_onSearchSubmit:function(e){e.preventDefault();var n=t(e.currentTarget).find("ul.typeahead li");n.length>0&&(window.location.href=t(n[0]).find("a").attr("href"))},_onSearchError:function(){this.isSearching=!1,this.ui.$searchForm.removeClass(this.classnames.active)}});return y}),define("modules/StatsLeaderboards",["require","jquery","underscore","modules/BaseModule","detection/ie","views/PageNavigationView","views/stats-leaderboards/StatsSummaryBlockView","views/stats-leaderboards/StatsSelectedView"],function(e){var t=e("jquery"),n=e("underscore"),r=e("modules/BaseModule"),i=e("detection/ie"),s=e("views/PageNavigationView"),o=e("views/stats-leaderboards/StatsSummaryBlockView"),u=e("views/stats-leaderboards/StatsSelectedView"),a=n.extend(r,{_initModule:function(){var e=t(".container"),n=e.find("#stats-leaderboards-landing-summary-block"),r=e.find("#stats-leaderboards-selected-rankings");e.addClass("stats-n-leaderboards"),i&&t("html").addClass("ie-relative-font-sizing");if(n.length)var s=new o;if(r.length)var a=new u;this._initNavigation()},_initNavigation:function(){var e=t(".page-navigation");if(!e.length)return;var n=new s({el:e})}});return a});